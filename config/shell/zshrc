# Zsh configuration file
# This file is sourced by interactive zsh shells
# It integrates with the modular dotfiles configuration system
# Set DEBUG_SHELL_INIT=1 to enable debug output during shell initialization

[[ -n "$DEBUG_SHELL_INIT" ]] && echo "[.zshrc] Loading .zshrc"

# Path to your Oh My Zsh installation.
export ZSH="$HOME/.oh-my-zsh"

# Set name of the theme to load
ZSH_THEME="robbyrussell"

# Which plugins would you like to load?
# Standard plugins can be found in $ZSH/plugins/
# Custom plugins may be added to $ZSH_CUSTOM/plugins/
# plugins=(git)

# Only load oh-my-zsh if not disabled (e.g., in Cursor Agent context)
if [[ -z "$DISABLE_OH_MY_ZSH" ]]; then
    source $ZSH/oh-my-zsh.sh
fi

# User configuration

# Source modular configuration files
# These are already loaded by .zshenv for non-interactive shells,
# but we source them again here for interactive shells to ensure
# all configurations are available

# Source interactive-only functions and aliases.
[[ -f ~/.config/shell/software.sh ]] && source ~/.config/shell/software.sh
[[ -f ~/.config/shell/aliases.sh ]] && source ~/.config/shell/aliases.sh

# Zsh-specific configurations
# History configuration
HISTSIZE=10000
SAVEHIST=10000
HISTFILE=~/.zsh_history
setopt HIST_IGNORE_DUPS
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_SAVE_NO_DUPS
setopt HIST_IGNORE_SPACE
setopt HIST_VERIFY
setopt SHARE_HISTORY

# Completion configuration
setopt AUTO_MENU
setopt COMPLETE_IN_WORD
setopt ALWAYS_TO_END

# kubectl completion for zsh
if command -v kubectl &> /dev/null; then
    source <(kubectl completion zsh)
fi

# Directory navigation
setopt AUTO_PUSHD
setopt PUSHD_IGNORE_DUPS
setopt PUSHD_SILENT

# Other useful options
setopt EXTENDED_GLOB
setopt NO_CASE_GLOB
setopt NUMERIC_GLOB_SORT

# Key bindings
bindkey '^[[A' history-substring-search-up
bindkey '^[[B' history-substring-search-down
bindkey '^[[1;5C' forward-word
bindkey '^[[1;5D' backward-word

# Custom functions and aliases can be added here
# Most are defined in ~/.config/shell/aliases.sh

# Example aliases (uncomment and modify as needed)
# alias zshconfig="mate ~/.zshrc"
# alias ohmyzsh="mate ~/.oh-my-zsh"

# Arpalus SDK token
export ARPALUS_REGISTRY_TOKEN=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI4MmRhMDE3NC05YzFiLTQ4NmQtYmNjNS02MTQzZTQyNDBjNzgiLCJpYXQiOjE3NDgwMjg5NjIsImV4cCI6MTc3OTU2NDk2Mn0._zavQ6AZgSkXoOgzOriN2WjULhnO854XCiI-ePVx0W4

# pnpm
export PNPM_HOME="/Users/pdfowler/Library/pnpm"
case ":$PATH:" in
  *":$PNPM_HOME:"*) ;;
  *) export PATH="$PNPM_HOME:$PATH" ;;
esac
# pnpm end
